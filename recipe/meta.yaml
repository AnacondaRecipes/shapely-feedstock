{% set name = "Shapely" %}
{% set version = "2.0.0" %}

package:
  name: {{ name|lower }}
  version: {{ version.split('.post')[0] }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name|lower }}-{{ version }}.tar.gz
  sha256: 11f1b1231a6c04213fb1226c6968d1b1b3b369ec42d1e9655066af87631860ea

build:
  number: 0
  # geos currently isn't available on s390x
  skip: True  # [py<37 or s390x]
  script:
    - set GEOS_INCLUDE_PATH=%LIBRARY_INC%  # [win]
    - set GEOS_LIBRARY_PATH=%LIBRARY_LIB%  # [win]
    - {{ PYTHON }} -m pip install . -vv

requirements:
  build:
    - {{ compiler('c') }}
  host:
    - python
    - cython
    - geos
    - numpy 1.19  # [(not (osx and arm64)) and py<310]
    - numpy 1.21  # [(osx and arm64) or py>=310]
    - pip
    - setuptools
    - wheel
  run:
    - python
    - {{ pin_compatible('numpy') }}

test:
  source_files:
    - tests
  requires:
    - pip
    - pytest
  imports:
    - shapely
    - shapely.algorithms
    - shapely.geometry
    - shapely.vectorized
  commands:
    - pip check
    - pytest --pyargs shapely.tests

about:
  home: https://github.com/shapely/shapely
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE.txt
  summary: "Python package for manipulation and analysis of geometric objects in the Cartesian plane"
  description: |
    Shapely is a BSD-licensed Python package for manipulation and analysis of
    planar geometric objects. Shapely is not a GIS package: it does not deal
    with spatial reference systems, formats, or coordinate systems. Shapely
    focuses on the geometric operations themselves, and the objects on which
    they operate. Shapely is fast and lightweight, with no external dependencies.
  dev_url: https://github.com/shapely/shapely
  doc_url: https://shapely.readthedocs.io/en/stable/

extra:
  recipe-maintainers:
    - ocefpaf
    - pelson
    - phobson
    - xylar
    - msarahan
